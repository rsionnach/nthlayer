{
  "id": "chunkhound-audit-secret-backend-security-hardening",
  "type": "epic",
  "title": "[ChunkHound Audit] Secret Backend Security Hardening",
  "description": "Address security issues in secret backend system.\n\n**Source:** docs/audits/chunkhound/runs/2026-01-02/03-secret-backends.md\n\n**Key Findings:**\n1. Error logging leaks secret paths & backend metadata:\n   - Vault: logger.debug('vault_secret_not_found', path=path, error=str(e))\n   - GCP: logger.debug('gcp_secret_not_found', path=path, error=str(e))\n   - Leaks attempted paths, backend type, Vault ACL rules, GCP project IDs\n\n2. Fallback chain creates silent bypass routes:\n   - Primary backend failure + fallback success = only debug log\n   - Attacker could compromise fallback backend without triggering alerts\n   - No security ranking validation of fallback chain\n\n3. Cloud backend misconfiguration silent failures:\n   - hvac not installed + vault_address set = silently skipped\n   - Only debug log emitted when ImportError caught\n   - User sees 'secret not found' not 'vault unavailable'\n\n4. File permissions issue:\n   - Parent dir created with default umask\n   - No atomic write (crash mid-write = partial file)\n   - No explicit permission check on config file load\n\n5. Hardcoded defaults expose secrets:\n   - ${secret:db/password|default:postgres} plaintext in config\n\n**Proposed Solutions:**\n1. Never log full path; use hash or redact\n2. Emit WARNING when fallback resolves (not debug)\n3. Validate fallback chain security ranking at init\n4. Emit WARNING when configured backend fails to load (not debug)\n5. Use atomic write pattern for credentials file\n6. Warn on hardcoded defaults in config files",
  "status": "open",
  "priority": "P2",
  "tags": [],
  "created_at": "2026-01-03T21:00:00Z",
  "updated_at": "2026-01-03T21:00:00Z",
  "legacy_id": "trellis-audit-secrets",
  "comments": [
    {
      "author": "chunkhound-audit",
      "text": "Source: 03-secret-backends.md - Secret Backend System End-to-End",
      "date": "2026-01-03T21:23:27Z"
    }
  ]
}

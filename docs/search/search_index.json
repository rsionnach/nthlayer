{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"NthLayer","text":"<p>Generate your complete reliability stack from a single service spec.</p> <p>20 hours of SRE work in 5 minutes. Zero toil.</p>"},{"location":"#what-is-nthlayer","title":"What is NthLayer?","text":"<p>NthLayer is an automation platform that generates your complete observability and reliability infrastructure from declarative service definitions. Define your service once, get:</p> Output Description Dashboards Grafana dashboards with technology-aware panels Alerts Prometheus alert rules with best-practice thresholds SLOs OpenSLO-compatible definitions with error budgets Recording Rules Pre-aggregated metrics for performance PagerDuty Teams, schedules, and escalation policies"},{"location":"#quick-example","title":"Quick Example","text":"service.yaml<pre><code>name: payment-api\ntier: critical\ntype: api\ndependencies:\n  - postgresql\n  - redis\n</code></pre> <pre><code>nthlayer apply service.yaml\n</code></pre> <p>Output: <pre><code>generated/payment-api/\n\u251c\u2500\u2500 dashboard.json       # Grafana dashboard\n\u251c\u2500\u2500 alerts.yaml          # Prometheus rules\n\u251c\u2500\u2500 slos.yaml            # OpenSLO definitions\n\u2514\u2500\u2500 recording-rules.yaml # Pre-aggregated metrics\n</code></pre></p>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#slo-portfolio","title":"SLO Portfolio","text":"<p>Track reliability across your entire organization:</p> <pre><code>================================================================================\n  NthLayer SLO Portfolio\n================================================================================\n\nOrganization Health: 78% (14/18 services meeting SLOs)\n\nBy Tier:\n  Critical:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591  83% (5/6 services)\n  Standard:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591  75% (6/8 services)\n  Low:       \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591  75% (3/4 services)\n\nServices Needing Attention:\n  payment-api    availability  156% budget burned  EXHAUSTED\n  search-api     latency       95% budget burned   WARNING\n</code></pre>"},{"location":"#18-technology-templates","title":"18 Technology Templates","text":"<p>Pre-built monitoring for:</p> <ul> <li>Databases: PostgreSQL, MySQL, MongoDB, Redis, Elasticsearch</li> <li>Message Queues: Kafka, RabbitMQ, NATS, Pulsar</li> <li>Proxies: Nginx, HAProxy, Traefik</li> <li>Infrastructure: Kubernetes, etcd, Consul</li> </ul>"},{"location":"#interactive-setup","title":"Interactive Setup","text":"<pre><code>nthlayer setup\n</code></pre> <p>Guided configuration for Prometheus, Grafana, and PagerDuty with connection testing.</p>"},{"location":"#get-started","title":"Get Started","text":"<ul> <li> <p> Installation</p> <p>Install NthLayer with pip or pipx</p> <p> Install</p> </li> <li> <p> Quick Start</p> <p>Generate your first dashboard in 5 minutes</p> <p> Quick Start</p> </li> <li> <p> Commands</p> <p>Full CLI reference</p> <p> Commands</p> </li> <li> <p> Integrations</p> <p>Connect to Prometheus, Grafana, PagerDuty</p> <p> Integrations</p> </li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>This page provides visual documentation of NthLayer's architecture, workflows, and integrations.</p>"},{"location":"architecture/#platform-architecture","title":"Platform Architecture","text":"<p>The NthLayer platform sits between your service definitions and your observability stack, generating the complete reliability infrastructure.</p> <pre><code>architecture-beta\n    group git(disk)[Git Repository]\n    group nthlayer(server)[NthLayer Platform]\n    group observability(cloud)[Observability Stack]\n\n    service specs(disk)[services/*.yaml] in git\n\n    service reslayer(server)[ResLayer - SLOs &amp; Error Budgets] in nthlayer\n    service govlayer(server)[GovLayer - Policy Enforcement] in nthlayer\n    service obslayer(server)[ObserveLayer - Monitoring] in nthlayer\n\n    service prometheus(server)[Prometheus] in observability\n    service grafana(server)[Grafana] in observability\n    service pagerduty(server)[PagerDuty] in observability\n    service loki(server)[Loki] in observability\n\n    specs:R --&gt; L:reslayer\n    specs:R --&gt; L:govlayer\n    specs:R --&gt; L:obslayer\n\n    reslayer:B --&gt; T:prometheus\n    obslayer:B --&gt; T:grafana\n    obslayer:B --&gt; T:pagerduty\n    obslayer:B --&gt; T:loki</code></pre>"},{"location":"architecture/#apply-workflow","title":"Apply Workflow","text":"<p>When you run <code>nthlayer apply</code>, the following artifacts are generated from your service specification:</p> <pre><code>architecture-beta\n    group input(disk)[Input]\n    group processing(server)[NthLayer Processing]\n    group output(cloud)[Generated Artifacts]\n\n    service yaml(disk)[service.yaml] in input\n\n    service parser(server)[Spec Parser] in processing\n    service slo_gen(server)[SLO Generator] in processing\n    service alert_gen(server)[Alert Generator] in processing\n    service dash_gen(server)[Dashboard Builder] in processing\n    service pd_gen(server)[PagerDuty Setup] in processing\n\n    service slos(disk)[slos.yaml] in output\n    service alerts(disk)[alerts.yaml] in output\n    service dashboard(disk)[dashboard.json] in output\n    service recording(disk)[recording-rules.yaml] in output\n    service pd_config(disk)[pagerduty-config.json] in output\n\n    yaml:R --&gt; L:parser\n    parser:R --&gt; L:slo_gen\n    parser:R --&gt; L:alert_gen\n    parser:R --&gt; L:dash_gen\n    parser:R --&gt; L:pd_gen\n\n    slo_gen:R --&gt; L:slos\n    slo_gen:R --&gt; L:recording\n    alert_gen:R --&gt; L:alerts\n    dash_gen:R --&gt; L:dashboard\n    pd_gen:R --&gt; L:pd_config</code></pre>"},{"location":"architecture/#integration-architecture","title":"Integration Architecture","text":"<p>NthLayer integrates with your existing observability stack without requiring changes to your infrastructure:</p> <pre><code>architecture-beta\n    group user(internet)[User Environment]\n    group nthlayer_cli(server)[NthLayer CLI]\n    group metrics(database)[Metrics Stack]\n    group incidents(cloud)[Incident Management]\n\n    service developer(internet)[Developer] in user\n    service ci_cd(server)[CI/CD Pipeline] in user\n    service k8s(server)[Kubernetes] in user\n\n    service apply(server)[nthlayer apply] in nthlayer_cli\n    service portfolio(server)[nthlayer portfolio] in nthlayer_cli\n    service setup(server)[nthlayer setup] in nthlayer_cli\n\n    service prom(database)[Prometheus] in metrics\n    service grafana(server)[Grafana Cloud] in metrics\n    service loki(database)[Loki] in metrics\n\n    service pagerduty(cloud)[PagerDuty] in incidents\n    service slack(cloud)[Slack] in incidents\n\n    developer:R --&gt; L:apply\n    ci_cd:B --&gt; T:apply\n\n    apply:R --&gt; L:prom\n    apply:R --&gt; L:grafana\n    apply:R --&gt; L:pagerduty\n\n    portfolio:R --&gt; L:prom\n    setup:R --&gt; L:grafana\n    setup:R --&gt; L:pagerduty\n\n    pagerduty:R --&gt; L:slack\n    prom:B --&gt; T:grafana</code></pre>"},{"location":"architecture/#slo-portfolio-flow","title":"SLO Portfolio Flow","text":"<p>The portfolio command aggregates SLO health across all services:</p> <pre><code>architecture-beta\n    group services(disk)[Service Definitions]\n    group collection(server)[Portfolio Collection]\n    group output(cloud)[Output]\n\n    service svc1(disk)[payment-api.yaml] in services\n    service svc2(disk)[checkout-service.yaml] in services\n    service svc3(disk)[notification-worker.yaml] in services\n\n    service scanner(server)[Service Scanner] in collection\n    service aggregator(server)[SLO Aggregator] in collection\n    service health(server)[Health Calculator] in collection\n\n    service text(internet)[Terminal Output] in output\n    service json(disk)[JSON Export] in output\n    service csv(disk)[CSV Export] in output\n\n    svc1:R --&gt; L:scanner\n    svc2:R --&gt; L:scanner\n    svc3:R --&gt; L:scanner\n\n    scanner:R --&gt; L:aggregator\n    aggregator:R --&gt; L:health\n\n    health:R --&gt; L:text\n    health:R --&gt; L:json\n    health:R --&gt; L:csv</code></pre>"},{"location":"architecture/#technology-support","title":"Technology Support","text":"<p>NthLayer generates technology-specific monitoring for 18+ technologies:</p> <pre><code>architecture-beta\n    group databases(database)[Databases]\n    group caches(server)[Caches &amp; Queues]\n    group infra(cloud)[Infrastructure]\n\n    service postgres(database)[PostgreSQL] in databases\n    service mysql(database)[MySQL] in databases\n    service mongodb(database)[MongoDB] in databases\n    service elasticsearch(database)[Elasticsearch] in databases\n\n    service redis(server)[Redis] in caches\n    service kafka(server)[Kafka] in caches\n    service rabbitmq(server)[RabbitMQ] in caches\n    service nats(server)[NATS] in caches\n\n    service nginx(cloud)[Nginx] in infra\n    service haproxy(cloud)[HAProxy] in infra\n    service traefik(cloud)[Traefik] in infra\n    service k8s(cloud)[Kubernetes] in infra</code></pre>"},{"location":"demo/","title":"Live Demo","text":""},{"location":"demo/#20-hours-of-sre-work-in-5-minutes","title":"20 Hours of SRE Work in 5 Minutes","text":"<p>Define your service once. NthLayer generates SLOs, alerts, dashboards, recording rules, and runbooks\u2014with technology-specific best practices built in.</p> <ul> <li> <p> 99.6% Time Savings</p> </li> <li> <p> Tech-Aware (PostgreSQL, Redis, Kafka)</p> </li> <li> <p> One Command for Everything</p> </li> <li> <p> Real-Time Error Budget Tracking</p> </li> </ul>"},{"location":"demo/#live-grafana-dashboards","title":"Live Grafana Dashboards","text":"<p>See auto-generated dashboards for 6 production services. Each dashboard includes SLO metrics, service health, and technology-specific panels.</p> <ul> <li> <p> payment-api</p> <p>PostgreSQL + Redis</p> <p> View Dashboard</p> </li> <li> <p> checkout-service</p> <p>MySQL + Redis</p> <p> View Dashboard</p> </li> <li> <p> notification-worker</p> <p>Worker + Redis</p> <p> View Dashboard</p> </li> <li> <p> analytics-stream</p> <p>Stream + MongoDB</p> <p> View Dashboard</p> </li> <li> <p> identity-service</p> <p>PostgreSQL + Redis</p> <p> View Dashboard</p> </li> <li> <p> search-api</p> <p>Elasticsearch + Redis</p> <p> View Dashboard</p> </li> </ul> <p>Dashboard Structure</p> <p>Each dashboard is organized into: SLO Metrics \u2192 Service Health \u2192 Dependencies</p>"},{"location":"demo/#generated-alerts","title":"Generated Alerts","text":"<p>118 production-ready Prometheus alerts across all services, sourced from awesome-prometheus-alerts.</p> <ul> <li> <p>payment-api \u00b7 15 PostgreSQL alerts</p> <p>PostgresqlDown, PostgresqlRestarted, SlowQueries...</p> <p> View on GitHub</p> </li> <li> <p>checkout-service \u00b7 26 MySQL + Redis alerts</p> <p>MysqlDown, RedisMemoryHigh, ReplicationLag...</p> <p> View on GitHub</p> </li> <li> <p>notification-worker \u00b7 12 Redis alerts</p> <p>RedisDown, RedisMemoryHigh, TooManyConnections...</p> <p> View on GitHub</p> </li> <li> <p>analytics-stream \u00b7 19 MongoDB + Redis alerts</p> <p>MongodbDown, CursorsTimeouts, ReplicasetLag...</p> <p> View on GitHub</p> </li> <li> <p>identity-service \u00b7 27 PostgreSQL + Redis alerts</p> <p>PostgresqlDown, DeadLocks, RedisRejected...</p> <p> View on GitHub</p> </li> <li> <p>search-api \u00b7 19 Elasticsearch alerts</p> <p>ClusterRed, JvmHeapHigh, DiskSpaceLow...</p> <p> View on GitHub</p> </li> </ul>"},{"location":"demo/#slo-portfolio","title":"SLO Portfolio","text":"<p>Track org-wide reliability with tier-based health scoring:</p> <pre><code>================================================================================\n  NthLayer SLO Portfolio\n================================================================================\n\nOrganization Health: 78% (14/18 services meeting SLOs)\n\nBy Tier:\n  Critical:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591  83% (5/6 services)\n  Standard:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591  75% (6/8 services)\n  Low:       \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591  75% (3/4 services)\n\n--------------------------------------------------------------------------------\nServices Needing Attention:\n--------------------------------------------------------------------------------\n\n  payment-api (Tier 1)\n    availability: 156% budget burned - EXHAUSTED\n    Remaining: -12.5 hours\n\n  search-api (Tier 2)\n    latency-p99: 95% budget burned - WARNING\n    Remaining: 1.2 hours\n\n--------------------------------------------------------------------------------\nTotal: 18 services, 16 with SLOs, 45 SLOs\n</code></pre> <p>Cross-Vendor Aggregation</p> <p>Why this matters: PagerDuty can't give you this view\u2014they want you locked into their ecosystem. NthLayer aggregates SLOs across any backend (Prometheus, Datadog, etc.) in a single, vendor-neutral portfolio.</p>"},{"location":"demo/#pagerduty-integration","title":"PagerDuty Integration","text":"<p>Complete incident response setup with tier-based escalation policies.</p> <ul> <li> <p> Team Management</p> <p>Auto-creates teams with manager roles assigned to API key owner</p> </li> <li> <p> On-Call Schedules</p> <p>Primary, secondary, and manager schedules with weekly rotation</p> </li> <li> <p> Tier-Based Timing</p> <p>Critical: 5\u219215\u219230min | High: 15\u219230\u219260min | Low: 60min only</p> </li> <li> <p> Service Linking</p> <p>Services linked to escalation policies with urgency settings</p> </li> </ul>"},{"location":"demo/#support-models","title":"Support Models","text":"Model Description <code>self</code> Team handles all alerts 24/7 <code>shared</code> Team (day) + SRE (off-hours) <code>sre</code> SRE handles all alerts <code>business_hours</code> Team (9-5) + low-priority queue"},{"location":"demo/#what-gets-generated","title":"What Gets Generated","text":"<p>From a single <code>service.yaml</code>, NthLayer generates:</p> Output Description Example Dashboard 22 panels: health, SLOs, latency, errors, dependencies View JSON SLOs 3 SLOs with 30-day error budgets and burn rate calculations View YAML Alerts 15 PostgreSQL alerts with service labels and severity routing View YAML Recording Rules 21 pre-aggregated metrics for 10x faster dashboard queries View YAML"},{"location":"demo/#try-it-yourself","title":"Try It Yourself","text":"<pre><code># Install NthLayer\npipx install nthlayer\n\n# Interactive setup (configures Prometheus, Grafana, PagerDuty)\nnthlayer setup\n\n# Generate configs for your service\nnthlayer apply payment-api.yaml\n\n# View org-wide SLO health\nnthlayer portfolio\n</code></pre> <ul> <li> <p> Get Started</p> <p>Install NthLayer and generate your first reliability stack</p> <p> Installation Guide</p> </li> <li> <p> Full Documentation</p> <p>Comprehensive guides for all features</p> <p> Documentation</p> </li> </ul>"},{"location":"commands/","title":"Commands Overview","text":"<p>NthLayer provides a comprehensive CLI for managing your reliability stack.</p>"},{"location":"commands/#core-commands","title":"Core Commands","text":"Command Description <code>nthlayer apply</code> Generate all configs from service spec <code>nthlayer setup</code> Interactive first-time setup <code>nthlayer portfolio</code> View org-wide SLO health <code>nthlayer slo</code> Query and manage SLOs <code>nthlayer config</code> Manage configuration"},{"location":"commands/#quick-reference","title":"Quick Reference","text":"<pre><code># Generate configs\nnthlayer apply service.yaml\n\n# Interactive setup\nnthlayer setup\n\n# View portfolio\nnthlayer portfolio\n\n# Check SLO status\nnthlayer slo show service.yaml\nnthlayer slo collect service.yaml\n\n# Manage config\nnthlayer config show\nnthlayer config init\n</code></pre>"},{"location":"commands/#getting-help","title":"Getting Help","text":"<pre><code>nthlayer --help\nnthlayer &lt;command&gt; --help\n</code></pre>"},{"location":"commands/apply/","title":"nthlayer apply","text":"<p>Generate all reliability configs from a service specification.</p>"},{"location":"commands/apply/#usage","title":"Usage","text":"<pre><code>nthlayer apply &lt;service.yaml&gt; [options]\n</code></pre>"},{"location":"commands/apply/#options","title":"Options","text":"Option Description <code>--push</code> Push dashboard to Grafana after generation <code>--output-dir DIR</code> Output directory (default: <code>generated/&lt;service&gt;</code>) <code>--dry-run</code> Show what would be generated without writing"},{"location":"commands/apply/#examples","title":"Examples","text":""},{"location":"commands/apply/#basic-generation","title":"Basic Generation","text":"<pre><code>nthlayer apply payment-api.yaml\n</code></pre> <p>Output: <pre><code>Generated: generated/payment-api/\n\u251c\u2500\u2500 dashboard.json       # Grafana dashboard\n\u251c\u2500\u2500 alerts.yaml          # Prometheus alert rules\n\u251c\u2500\u2500 slos.yaml            # OpenSLO definitions\n\u2514\u2500\u2500 recording-rules.yaml # Prometheus recording rules\n</code></pre></p>"},{"location":"commands/apply/#push-to-grafana","title":"Push to Grafana","text":"<pre><code>nthlayer apply payment-api.yaml --push\n</code></pre> <p>Requires <code>NTHLAYER_GRAFANA_URL</code> and <code>NTHLAYER_GRAFANA_API_KEY</code> to be configured.</p>"},{"location":"commands/apply/#custom-output-directory","title":"Custom Output Directory","text":"<pre><code>nthlayer apply payment-api.yaml --output-dir ./configs/payment-api\n</code></pre>"},{"location":"commands/apply/#what-gets-generated","title":"What Gets Generated","text":""},{"location":"commands/apply/#dashboard-dashboardjson","title":"Dashboard (dashboard.json)","text":"<p>A Grafana dashboard with:</p> <ul> <li>SLO Metrics Row: Availability, latency, error budget</li> <li>Service Health Row: Request rate, active connections, saturation</li> <li>Dependencies Row: Panels for each configured dependency (PostgreSQL, Redis, etc.)</li> </ul>"},{"location":"commands/apply/#alerts-alertsyaml","title":"Alerts (alerts.yaml)","text":"<p>Prometheus alert rules including:</p> <ul> <li>High error rate alerts</li> <li>Latency threshold alerts</li> <li>Error budget burn rate alerts</li> <li>Dependency-specific alerts (e.g., PostgreSQL replication lag)</li> </ul>"},{"location":"commands/apply/#slos-slosyaml","title":"SLOs (slos.yaml)","text":"<p>OpenSLO-compatible definitions:</p> <pre><code>apiVersion: openslo/v1\nkind: SLO\nmetadata:\n  name: payment-api-availability\nspec:\n  service: payment-api\n  indicator:\n    metadata:\n      name: availability\n    spec:\n      ratioMetric:\n        good:\n          metricSource:\n            type: prometheus\n            spec:\n              query: sum(rate(http_requests_total{service=\"payment-api\",status!~\"5..\"}[5m]))\n        total:\n          metricSource:\n            type: prometheus\n            spec:\n              query: sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n  objectives:\n    - target: 0.9995\n      window: 30d\n</code></pre>"},{"location":"commands/apply/#recording-rules-recording-rulesyaml","title":"Recording Rules (recording-rules.yaml)","text":"<p>Pre-aggregated metrics for dashboard performance:</p> <pre><code>groups:\n  - name: payment-api-recording\n    rules:\n      - record: service:http_requests:rate5m\n        expr: sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n      - record: service:http_errors:rate5m\n        expr: sum(rate(http_requests_total{service=\"payment-api\",status=~\"5..\"}[5m]))\n</code></pre>"},{"location":"commands/apply/#see-also","title":"See Also","text":"<ul> <li>Service YAML Schema - Full spec reference</li> <li>CLI Reference - All commands</li> </ul>"},{"location":"commands/config/","title":"nthlayer config","text":"<p>Manage NthLayer configuration.</p>"},{"location":"commands/config/#commands","title":"Commands","text":"<pre><code>nthlayer config show              # Show current configuration\nnthlayer config init              # Interactive configuration wizard\nnthlayer config set KEY VALUE     # Set a configuration value\n</code></pre>"},{"location":"commands/config/#nthlayer-config-show","title":"nthlayer config show","text":"<p>Display current configuration:</p> <pre><code>nthlayer config show\n</code></pre> <pre><code>============================================================\n  NthLayer Configuration\n============================================================\n\nConfig file: /Users/you/.nthlayer/config.yaml\n\nPrometheus:\n  Default profile: default\n  [default] *\n    Type: prometheus\n    URL: http://localhost:9090\n\nGrafana:\n  Default profile: default\n  [default] *\n    Type: grafana\n    URL: http://localhost:3000\n    Org ID: 1\n    API Key: ****\n\nAlerting:\n  PagerDuty: enabled\n    Escalation Policy: P123ABC\n  Slack: disabled\n  Datadog: disabled\n</code></pre>"},{"location":"commands/config/#reveal-secrets","title":"Reveal Secrets","text":"<pre><code>nthlayer config show --reveal-secrets\n</code></pre>"},{"location":"commands/config/#nthlayer-config-init","title":"nthlayer config init","text":"<p>Interactive wizard for advanced configuration:</p> <pre><code>nthlayer config init\n</code></pre> <p>This is the advanced version of <code>nthlayer setup</code> with options for:</p> <ul> <li>Multiple environment profiles</li> <li>Cloud secret backends (Vault, AWS, Azure, GCP, Doppler)</li> <li>Detailed alerting configuration</li> </ul>"},{"location":"commands/config/#nthlayer-config-set","title":"nthlayer config set","text":"<p>Set individual configuration values:</p> <pre><code># Set Prometheus URL\nnthlayer config set prometheus.profiles.default.url http://prometheus:9090\n\n# Set Grafana API key (prompts for secret)\nnthlayer config set grafana.profiles.default.api_key --secret\n\n# Enable PagerDuty\nnthlayer config set alerting.pagerduty.enabled true\n</code></pre>"},{"location":"commands/config/#configuration-file","title":"Configuration File","text":"<p>Located at <code>~/.nthlayer/config.yaml</code>:</p> <pre><code>prometheus:\n  default: default\n  profiles:\n    default:\n      name: default\n      type: prometheus\n      url: http://localhost:9090\n    production:\n      name: production\n      type: grafana-cloud\n      url: https://prometheus-prod.grafana.net\n      username: 12345\n      password_secret: prometheus/prod/password\n\ngrafana:\n  default: default\n  profiles:\n    default:\n      name: default\n      type: grafana\n      url: http://localhost:3000\n      org_id: 1\n      api_key_secret: grafana/api_key\n\nalerting:\n  pagerduty:\n    enabled: true\n    api_key_secret: pagerduty/api_key\n    default_escalation_policy: P123ABC\n  slack:\n    enabled: false\n    webhook_url_secret: slack/webhook_url\n    default_channel: \"#alerts\"\n  datadog:\n    enabled: false\n</code></pre>"},{"location":"commands/config/#environment-variables","title":"Environment Variables","text":"<p>Override configuration with environment variables:</p> <pre><code># Prometheus\nexport NTHLAYER_PROMETHEUS_URL=http://prometheus:9090\n\n# Grafana\nexport NTHLAYER_GRAFANA_URL=http://grafana:3000\nexport NTHLAYER_GRAFANA_API_KEY=glsa_xxxxx\nexport NTHLAYER_GRAFANA_ORG_ID=1\n\n# PagerDuty\nexport PAGERDUTY_API_KEY=u+xxxxx\n</code></pre>"},{"location":"commands/config/#multiple-profiles","title":"Multiple Profiles","text":"<p>Use different configurations for different environments:</p> <pre><code># Use production profile\nexport NTHLAYER_PROFILE=production\nnthlayer apply service.yaml\n\n# Or specify inline\nnthlayer apply service.yaml --profile production\n</code></pre>"},{"location":"commands/config/#see-also","title":"See Also","text":"<ul> <li>nthlayer setup - Quick setup wizard</li> <li>Integrations - Integration guides</li> </ul>"},{"location":"commands/portfolio/","title":"nthlayer portfolio","text":"<p>View SLO health across your entire organization.</p>"},{"location":"commands/portfolio/#usage","title":"Usage","text":"<pre><code>nthlayer portfolio [options]\n</code></pre>"},{"location":"commands/portfolio/#options","title":"Options","text":"Option Description <code>--format FORMAT</code> Output format: <code>text</code> (default), <code>json</code>, <code>csv</code> <code>--services-dir DIR</code> Directory to scan for services"},{"location":"commands/portfolio/#example-output","title":"Example Output","text":"<pre><code>nthlayer portfolio\n</code></pre> <pre><code>================================================================================\n  NthLayer SLO Portfolio\n================================================================================\n\nOrganization Health: 78% (14/18 services meeting SLOs)\n\nBy Tier:\n  Tier 1 (Critical):     83%  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591  5/6 services\n  Tier 2 (Standard):     75%  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591  6/8 services\n  Tier 3 (Low):          75%  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591  3/4 services\n\n--------------------------------------------------------------------------------\nServices Needing Attention:\n--------------------------------------------------------------------------------\n\n  payment-api (Tier 1)\n    availability: 156% budget burned - EXHAUSTED\n    Remaining: -12.5 hours\n\n  search-api (Tier 2)\n    latency-p99: 95% budget burned - WARNING\n    Remaining: 1.2 hours\n\n--------------------------------------------------------------------------------\nInsights:\n--------------------------------------------------------------------------------\n  - 2 services have no SLOs defined: legacy-api, internal-tools\n  - payment-api has aggressive targets (99.99%) - consider 99.95%\n\n--------------------------------------------------------------------------------\nTotal: 18 services, 16 with SLOs, 45 SLOs\n</code></pre>"},{"location":"commands/portfolio/#json-export","title":"JSON Export","text":"<p>For integration with other tools:</p> <pre><code>nthlayer portfolio --format json\n</code></pre> <pre><code>{\n  \"timestamp\": \"2024-12-06T10:30:00Z\",\n  \"total_services\": 18,\n  \"services_with_slos\": 16,\n  \"total_slos\": 45,\n  \"healthy_services\": 14,\n  \"org_health_percent\": 77.78,\n  \"by_tier\": [\n    {\n      \"tier\": 1,\n      \"tier_name\": \"Critical\",\n      \"total_services\": 6,\n      \"healthy_services\": 5,\n      \"health_percent\": 83.33\n    }\n  ],\n  \"services\": [\n    {\n      \"name\": \"payment-api\",\n      \"tier\": 1,\n      \"overall_status\": \"exhausted\",\n      \"slos\": [\n        {\n          \"name\": \"availability\",\n          \"status\": \"exhausted\",\n          \"budget_consumed_percent\": 156.0\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"commands/portfolio/#csv-export","title":"CSV Export","text":"<p>For spreadsheet analysis:</p> <pre><code>nthlayer portfolio --format csv\n</code></pre> <pre><code>service,tier,slo,status,budget_consumed,budget_remaining_hours\npayment-api,1,availability,exhausted,156.0,-12.5\npayment-api,1,latency-p99,healthy,45.0,18.2\nsearch-api,2,availability,healthy,32.0,22.1\nsearch-api,2,latency-p99,warning,95.0,1.2\n</code></pre>"},{"location":"commands/portfolio/#health-status-levels","title":"Health Status Levels","text":"Status Budget Consumed Description Healthy &lt; 80% On track Warning 80-100% Approaching limit Critical 100-150% Over budget Exhausted &gt; 150% Severely over budget"},{"location":"commands/portfolio/#scanning-multiple-directories","title":"Scanning Multiple Directories","text":"<pre><code>nthlayer portfolio --services-dir ./services --services-dir ./legacy\n</code></pre> <p>Default search paths: - <code>./services</code> - <code>./examples/services</code></p>"},{"location":"commands/portfolio/#use-cases","title":"Use Cases","text":""},{"location":"commands/portfolio/#weekly-slo-review","title":"Weekly SLO Review","text":"<pre><code>nthlayer portfolio --format json &gt; slo-report-$(date +%Y%m%d).json\n</code></pre>"},{"location":"commands/portfolio/#cicd-gate","title":"CI/CD Gate","text":"<pre><code># Fail if any critical service is exhausted\nnthlayer portfolio --format json | jq -e '.services[] | select(.tier == 1 and .overall_status == \"exhausted\") | empty'\n</code></pre>"},{"location":"commands/portfolio/#stakeholder-reports","title":"Stakeholder Reports","text":"<pre><code>nthlayer portfolio --format csv &gt; monthly-slo-report.csv\n</code></pre>"},{"location":"commands/portfolio/#see-also","title":"See Also","text":"<ul> <li>SLOs &amp; Error Budgets - Understanding SLOs</li> <li>nthlayer slo - Per-service SLO commands</li> </ul>"},{"location":"commands/setup/","title":"nthlayer setup","text":"<p>Interactive first-time setup wizard for NthLayer.</p>"},{"location":"commands/setup/#usage","title":"Usage","text":"<pre><code>nthlayer setup [options]\n</code></pre>"},{"location":"commands/setup/#options","title":"Options","text":"Option Description <code>--quick</code> Use simplified setup (default) <code>--advanced</code> Use full configuration wizard <code>--test</code> Test connections only <code>--skip-service</code> Skip first service creation prompt"},{"location":"commands/setup/#quick-setup-mode","title":"Quick Setup Mode","text":"<p>The default mode configures the essentials:</p> <pre><code>nthlayer setup\n</code></pre> <pre><code>================================================================================\n  Welcome to NthLayer!\n  The missing layer of reliability - 20 hours of SRE work in 5 minutes\n================================================================================\n\nQuick Setup\n----------------------------------------\n1. Prometheus Configuration\n   Prometheus URL [http://localhost:9090]:\n   Does Prometheus require authentication? [y/N]:\n\n2. Grafana Configuration (optional)\n   Configure Grafana? [Y/n]: y\n   Grafana URL [http://localhost:3000]:\n   API Key (press Enter to skip): ****\n\n3. PagerDuty Configuration (optional)\n   Configure PagerDuty? [y/N]:\n\nTesting Connections\n----------------------------------------\n  Prometheus (http://localhost:9090)\n    [OK] Connected (Prometheus 2.45.0)\n\n  Grafana (http://localhost:3000)\n    [OK] Connected - Org: Main Org\n\nConfiguration saved to: ~/.nthlayer/config.yaml\n\nCreate your first service? [Y/n]:\n</code></pre>"},{"location":"commands/setup/#advanced-setup-mode","title":"Advanced Setup Mode","text":"<p>For power users with multiple environments:</p> <pre><code>nthlayer setup --advanced\n</code></pre> <p>This includes:</p> <ul> <li>Multiple Prometheus/Grafana profiles (dev, staging, prod)</li> <li>Cloud secret backends (Vault, AWS Secrets Manager, etc.)</li> <li>Detailed PagerDuty and Slack configuration</li> </ul>"},{"location":"commands/setup/#test-connections-only","title":"Test Connections Only","text":"<p>Verify your configuration:</p> <pre><code>nthlayer setup --test\n</code></pre> <pre><code>Testing Connections\n----------------------------------------\n  Prometheus (http://localhost:9090)\n    [OK] Connected (Prometheus 2.45.0)\n\n  Grafana (http://localhost:3000)\n    [OK] Connected - Org: Main Org\n\n  PagerDuty\n    [OK] Connected - 3 escalation policies\n\nAll configured services are operational!\n</code></pre>"},{"location":"commands/setup/#configuration-file","title":"Configuration File","text":"<p>Setup creates <code>~/.nthlayer/config.yaml</code>:</p> <pre><code>prometheus:\n  default: default\n  profiles:\n    default:\n      url: http://localhost:9090\n      type: prometheus\n\ngrafana:\n  default: default\n  profiles:\n    default:\n      url: http://localhost:3000\n      type: grafana\n      api_key_secret: grafana/api_key\n\nalerting:\n  pagerduty:\n    enabled: false\n  slack:\n    enabled: false\n</code></pre>"},{"location":"commands/setup/#environment-variables","title":"Environment Variables","text":"<p>Alternatively, configure via environment variables:</p> <pre><code>export NTHLAYER_PROMETHEUS_URL=http://prometheus:9090\nexport NTHLAYER_GRAFANA_URL=http://grafana:3000\nexport NTHLAYER_GRAFANA_API_KEY=glsa_xxxxx\nexport PAGERDUTY_API_KEY=u+xxxxx\n</code></pre>"},{"location":"commands/setup/#see-also","title":"See Also","text":"<ul> <li>nthlayer config - Manual configuration</li> <li>Quick Start - Full setup guide</li> </ul>"},{"location":"commands/slo/","title":"nthlayer slo","text":"<p>Query and manage SLOs for individual services.</p>"},{"location":"commands/slo/#commands","title":"Commands","text":"<pre><code>nthlayer slo show &lt;service.yaml&gt;     # Show SLO definitions\nnthlayer slo list &lt;service.yaml&gt;     # List SLOs briefly\nnthlayer slo collect &lt;service.yaml&gt;  # Query live metrics from Prometheus\n</code></pre>"},{"location":"commands/slo/#nthlayer-slo-show","title":"nthlayer slo show","text":"<p>Display detailed SLO information:</p> <pre><code>nthlayer slo show payment-api.yaml\n</code></pre> <pre><code>================================================================================\n  SLOs for payment-api\n================================================================================\n\navailability\n  Type: availability\n  Objective: 99.95%\n  Window: 30 days\n  Error Budget: 21.6 minutes/month\n\nlatency-p99\n  Type: latency\n  Objective: 99.0% of requests &lt; 200ms\n  Window: 30 days\n  Percentile: p99\n</code></pre>"},{"location":"commands/slo/#nthlayer-slo-list","title":"nthlayer slo list","text":"<p>Brief listing:</p> <pre><code>nthlayer slo list payment-api.yaml\n</code></pre> <pre><code>payment-api SLOs:\n  - availability: 99.95% (30d)\n  - latency-p99: 99.0% &lt; 200ms (30d)\n</code></pre>"},{"location":"commands/slo/#nthlayer-slo-collect","title":"nthlayer slo collect","text":"<p>Query live metrics from Prometheus:</p> <pre><code>nthlayer slo collect payment-api.yaml\n</code></pre> <pre><code>================================================================================\n  Live SLO Status: payment-api\n================================================================================\n\navailability\n  Current: 99.92%\n  Target: 99.95%\n  Status: WARNING (approaching budget)\n  Budget Consumed: 87.5%\n  Budget Remaining: 2.7 hours\n\nlatency-p99\n  Current: 185ms\n  Target: 200ms\n  Status: HEALTHY\n  Budget Consumed: 45.2%\n  Budget Remaining: 11.8 hours\n</code></pre>"},{"location":"commands/slo/#options","title":"Options","text":"Option Description <code>--prometheus-url URL</code> Prometheus server URL <code>--window DURATION</code> Query window (default: 30d)"},{"location":"commands/slo/#environment-variables","title":"Environment Variables","text":"<pre><code>export NTHLAYER_PROMETHEUS_URL=http://prometheus:9090\n</code></pre>"},{"location":"commands/slo/#understanding-slo-status","title":"Understanding SLO Status","text":"Status Meaning HEALTHY &lt; 80% budget consumed WARNING 80-100% budget consumed CRITICAL 100-150% budget consumed EXHAUSTED &gt; 150% budget consumed"},{"location":"commands/slo/#error-budget-calculation","title":"Error Budget Calculation","text":"<p>For a 99.95% availability SLO over 30 days:</p> <pre><code>Error Budget = (1 - 0.9995) \u00d7 30 days \u00d7 24 hours \u00d7 60 minutes\n             = 0.0005 \u00d7 43,200 minutes\n             = 21.6 minutes\n</code></pre>"},{"location":"commands/slo/#see-also","title":"See Also","text":"<ul> <li>nthlayer portfolio - Org-wide SLO view</li> <li>SLOs &amp; Error Budgets - Concepts</li> </ul>"},{"location":"concepts/service-specs/","title":"Service Specifications","text":"<p>A service spec is a YAML file that describes your service and its reliability requirements.</p>"},{"location":"concepts/service-specs/#structure","title":"Structure","text":"<pre><code># Basic metadata\nname: payment-api\nteam: payments\ntier: critical      # 1, 2, 3 or critical, standard, low\ntype: api           # api, worker, stream\n\n# Dependencies (optional)\ndependencies:\n  - postgresql\n  - redis\n\n# Custom resources (optional)\nresources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.95\n      ...\n</code></pre>"},{"location":"concepts/service-specs/#required-fields","title":"Required Fields","text":"Field Description <code>name</code> Service identifier (lowercase, hyphens allowed) <code>tier</code> Priority level: <code>1</code>/<code>critical</code>, <code>2</code>/<code>standard</code>, <code>3</code>/<code>low</code> <code>type</code> Service type: <code>api</code>, <code>worker</code>, <code>stream</code>"},{"location":"concepts/service-specs/#optional-fields","title":"Optional Fields","text":"Field Description <code>team</code> Team responsible for the service <code>description</code> Human-readable description <code>dependencies</code> List of technology dependencies <code>resources</code> Custom SLO, alert, or PagerDuty configs"},{"location":"concepts/service-specs/#service-types","title":"Service Types","text":""},{"location":"concepts/service-specs/#api-type-api","title":"API (<code>type: api</code>)","text":"<p>HTTP/REST services with request/response patterns.</p> <p>Default Metrics:</p> <ul> <li><code>http_requests_total</code> - Request count by status</li> <li><code>http_request_duration_seconds</code> - Latency histogram</li> </ul> <p>Default SLOs:</p> <ul> <li>Availability: % of non-5xx responses</li> <li>Latency: p99 response time</li> </ul>"},{"location":"concepts/service-specs/#worker-type-worker","title":"Worker (<code>type: worker</code>)","text":"<p>Background job processors.</p> <p>Default Metrics:</p> <ul> <li><code>job_processed_total</code> - Jobs completed</li> <li><code>job_duration_seconds</code> - Processing time</li> <li><code>job_failed_total</code> - Failed jobs</li> </ul> <p>Default SLOs:</p> <ul> <li>Throughput: Jobs processed per minute</li> <li>Success rate: % of successful jobs</li> </ul>"},{"location":"concepts/service-specs/#stream-type-stream","title":"Stream (<code>type: stream</code>)","text":"<p>Event/message processors.</p> <p>Default Metrics:</p> <ul> <li><code>messages_processed_total</code> - Messages handled</li> <li><code>consumer_lag</code> - Messages behind</li> <li><code>processing_duration_seconds</code> - Processing time</li> </ul> <p>Default SLOs:</p> <ul> <li>Throughput: Messages per second</li> <li>Lag: Consumer lag in messages</li> </ul>"},{"location":"concepts/service-specs/#dependencies","title":"Dependencies","text":"<p>List technologies your service depends on:</p> <pre><code>dependencies:\n  - postgresql\n  - redis\n  - kafka\n</code></pre> <p>Each dependency adds:</p> <ul> <li>Dashboard panels with technology-specific metrics</li> <li>Alerts for common failure modes</li> <li>Recording rules for aggregation</li> </ul> <p>See Technologies for all 18 supported technologies.</p>"},{"location":"concepts/service-specs/#custom-resources","title":"Custom Resources","text":"<p>Override defaults or add custom configurations:</p>"},{"location":"concepts/service-specs/#custom-slo","title":"Custom SLO","text":"<pre><code>resources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.99        # Override default\n      window: 7d              # Custom window\n      indicator:\n        type: availability\n        query: |\n          sum(rate(http_requests_total{service=\"payment-api\",status!~\"5..\"}[5m])) /\n          sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n</code></pre>"},{"location":"concepts/service-specs/#custom-alert","title":"Custom Alert","text":"<pre><code>resources:\n  - kind: Alert\n    name: high-latency\n    spec:\n      expr: |\n        histogram_quantile(0.99,\n          sum by (le) (rate(http_request_duration_seconds_bucket{service=\"payment-api\"}[5m]))\n        ) &gt; 0.5\n      for: 5m\n      severity: warning\n      annotations:\n        summary: \"High latency on payment-api\"\n</code></pre>"},{"location":"concepts/service-specs/#pagerduty","title":"PagerDuty","text":"<pre><code>resources:\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      urgency: high\n      auto_create: true\n</code></pre>"},{"location":"concepts/service-specs/#environment-overrides","title":"Environment Overrides","text":"<p>Different settings per environment:</p> <pre><code># payment-api.yaml\nname: payment-api\ntier: critical\ntype: api\n\nenvironments:\n  production:\n    resources:\n      - kind: SLO\n        name: availability\n        spec:\n          objective: 99.99\n\n  staging:\n    resources:\n      - kind: SLO\n        name: availability\n        spec:\n          objective: 99.9\n</code></pre>"},{"location":"concepts/service-specs/#validation","title":"Validation","text":"<p>Validate your spec before applying:</p> <pre><code>nthlayer validate payment-api.yaml\n</code></pre> <pre><code>\u2713 payment-api.yaml is valid\n  - 2 SLOs defined\n  - 2 dependencies (postgresql, redis)\n  - PagerDuty integration enabled\n</code></pre>"},{"location":"concepts/service-specs/#examples","title":"Examples","text":"<p>See the examples/services directory for complete examples.</p>"},{"location":"concepts/slos/","title":"SLOs &amp; Error Budgets","text":"<p>Service Level Objectives (SLOs) are the foundation of reliability engineering.</p>"},{"location":"concepts/slos/#what-is-an-slo","title":"What is an SLO?","text":"<p>An SLO is a target for service reliability, expressed as:</p> <p>\"99.9% of requests should succeed over a 30-day window\"</p> <p>Components:</p> <ul> <li>Objective: The target (99.9%)</li> <li>Indicator: What we measure (successful requests)</li> <li>Window: Time period (30 days)</li> </ul>"},{"location":"concepts/slos/#error-budgets","title":"Error Budgets","text":"<p>The error budget is the inverse of your SLO:</p> <pre><code>Error Budget = 100% - SLO Objective\n</code></pre> <p>For a 99.9% SLO over 30 days:</p> <pre><code>Error Budget = 0.1% \u00d7 30 days \u00d7 24 hours \u00d7 60 minutes\n             = 43.2 minutes of allowed downtime\n</code></pre>"},{"location":"concepts/slos/#how-nthlayer-uses-slos","title":"How NthLayer Uses SLOs","text":""},{"location":"concepts/slos/#1-automatic-generation","title":"1. Automatic Generation","text":"<p>Define your tier, get sensible defaults:</p> <pre><code>name: payment-api\ntier: critical  # Gets 99.95% availability target\ntype: api\n</code></pre>"},{"location":"concepts/slos/#2-dashboard-visualization","title":"2. Dashboard Visualization","text":"<p>Generated dashboards show:</p> <ul> <li>Current SLO compliance</li> <li>Error budget remaining</li> <li>Burn rate trends</li> </ul>"},{"location":"concepts/slos/#3-portfolio-view","title":"3. Portfolio View","text":"<p>See all services at once:</p> <pre><code>nthlayer portfolio\n</code></pre>"},{"location":"concepts/slos/#4-live-queries","title":"4. Live Queries","text":"<p>Query Prometheus for real-time status:</p> <pre><code>nthlayer slo collect payment-api.yaml\n</code></pre>"},{"location":"concepts/slos/#slo-types","title":"SLO Types","text":""},{"location":"concepts/slos/#availability-slo","title":"Availability SLO","text":"<p>Percentage of successful requests:</p> <pre><code>resources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.95\n      window: 30d\n      indicator:\n        type: availability\n        query: |\n          sum(rate(http_requests_total{service=\"$service\",status!~\"5..\"}[5m])) /\n          sum(rate(http_requests_total{service=\"$service\"}[5m]))\n</code></pre>"},{"location":"concepts/slos/#latency-slo","title":"Latency SLO","text":"<p>Percentage of requests under a threshold:</p> <pre><code>resources:\n  - kind: SLO\n    name: latency-p99\n    spec:\n      objective: 99.0\n      window: 30d\n      threshold_ms: 200\n      indicator:\n        type: latency\n        percentile: 99\n        query: |\n          histogram_quantile(0.99,\n            sum by (le) (rate(http_request_duration_seconds_bucket{service=\"$service\"}[5m]))\n          )\n</code></pre>"},{"location":"concepts/slos/#throughput-slo","title":"Throughput SLO","text":"<p>Minimum requests/operations per second:</p> <pre><code>resources:\n  - kind: SLO\n    name: throughput\n    spec:\n      objective: 99.0\n      window: 30d\n      threshold_rps: 100\n      indicator:\n        type: throughput\n        query: sum(rate(http_requests_total{service=\"$service\"}[5m]))\n</code></pre>"},{"location":"concepts/slos/#tier-based-defaults","title":"Tier-Based Defaults","text":"Tier Availability Latency (p99) Error Budget Critical 99.95% 200ms 21.6 min/month Standard 99.9% 500ms 43.2 min/month Low 99.5% 1000ms 216 min/month"},{"location":"concepts/slos/#budget-consumption","title":"Budget Consumption","text":"<p>NthLayer tracks how much budget has been consumed:</p> Status Budget Consumed Action Healthy &lt; 80% Continue normal development Warning 80-100% Slow down, focus on stability Critical 100-150% Freeze changes, investigate Exhausted &gt; 150% Incident mode, all hands"},{"location":"concepts/slos/#best-practices","title":"Best Practices","text":""},{"location":"concepts/slos/#1-start-conservative","title":"1. Start Conservative","text":"<p>Begin with achievable targets and tighten over time:</p> <pre><code># Start here\ntier: standard  # 99.9%\n\n# After proving stability\ntier: critical  # 99.95%\n</code></pre>"},{"location":"concepts/slos/#2-match-business-impact","title":"2. Match Business Impact","text":"<p>Tier should reflect business criticality:</p> <ul> <li>Critical: Payment processing, authentication</li> <li>Standard: Main application features</li> <li>Low: Internal tools, analytics</li> </ul>"},{"location":"concepts/slos/#3-use-multiple-slos","title":"3. Use Multiple SLOs","text":"<p>Cover different failure modes:</p> <pre><code>resources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.95\n\n  - kind: SLO\n    name: latency-p99\n    spec:\n      objective: 99.0\n      threshold_ms: 200\n\n  - kind: SLO\n    name: latency-p50\n    spec:\n      objective: 99.9\n      threshold_ms: 50\n</code></pre>"},{"location":"concepts/slos/#4-review-regularly","title":"4. Review Regularly","text":"<p>Use the portfolio view for weekly reviews:</p> <pre><code>nthlayer portfolio --format json &gt; slo-review-$(date +%Y%m%d).json\n</code></pre>"},{"location":"concepts/slos/#further-reading","title":"Further Reading","text":"<ul> <li>Google SRE Book - SLOs</li> <li>The Art of SLOs</li> </ul>"},{"location":"getting-started/first-service/","title":"Your First Service","text":"<p>Learn how to create a complete service specification.</p>"},{"location":"getting-started/first-service/#minimal-service","title":"Minimal Service","text":"<p>The simplest service spec:</p> <pre><code>name: my-api\ntier: standard\ntype: api\n</code></pre> <p>This generates default SLOs for a standard API (99.9% availability, 500ms p99 latency).</p>"},{"location":"getting-started/first-service/#complete-service-example","title":"Complete Service Example","text":"<pre><code>name: payment-api\nteam: payments\ntier: critical        # 1=critical, 2=standard, 3=low\ntype: api             # api, worker, stream\n\n# Technology dependencies\ndependencies:\n  - postgresql\n  - redis\n\n# Custom SLO overrides\nresources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.95\n      window: 30d\n      indicator:\n        type: availability\n        query: |\n          sum(rate(http_requests_total{service=\"payment-api\",status!~\"5..\"}[5m])) /\n          sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n\n  - kind: SLO\n    name: latency-p99\n    spec:\n      objective: 99.0\n      window: 30d\n      threshold_ms: 200\n      indicator:\n        type: latency\n        percentile: 99\n\n  # PagerDuty configuration\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      urgency: high\n      auto_create: true\n</code></pre>"},{"location":"getting-started/first-service/#service-tiers","title":"Service Tiers","text":"Tier Availability Latency (p99) Escalation 1 (Critical) 99.95% 200ms 5 min 2 (Standard) 99.9% 500ms 15 min 3 (Low) 99.5% 1000ms 30 min"},{"location":"getting-started/first-service/#service-types","title":"Service Types","text":"Type Description Key Metrics api HTTP/REST services Request rate, latency, error rate worker Background jobs Job throughput, duration, failure rate stream Event processors Messages/sec, lag, processing time"},{"location":"getting-started/first-service/#dependencies","title":"Dependencies","text":"<p>NthLayer generates monitoring for these technologies:</p> DatabasesMessage QueuesProxiesInfrastructure <ul> <li><code>postgresql</code> - Connections, replication, locks</li> <li><code>mysql</code> - Connections, queries, replication</li> <li><code>mongodb</code> - Connections, operations, replication</li> <li><code>redis</code> - Memory, connections, hit rate</li> <li><code>elasticsearch</code> - Cluster health, indexing, search</li> </ul> <ul> <li><code>kafka</code> - Consumer lag, partitions, throughput</li> <li><code>rabbitmq</code> - Queue depth, consumers, rates</li> <li><code>nats</code> - Connections, messages, subscriptions</li> <li><code>pulsar</code> - Throughput, backlog, storage</li> </ul> <ul> <li><code>nginx</code> - Requests, connections, upstream</li> <li><code>haproxy</code> - Backend health, response time</li> <li><code>traefik</code> - Requests, entrypoints</li> </ul> <ul> <li><code>kubernetes</code> - Pod health, resources</li> <li><code>etcd</code> - Leader, proposals, DB size</li> <li><code>consul</code> - Health checks, services</li> </ul>"},{"location":"getting-started/first-service/#generate-and-apply","title":"Generate and Apply","text":"<pre><code># Preview what will be generated\nnthlayer plan payment-api.yaml\n\n# Generate all configs\nnthlayer apply payment-api.yaml\n\n# Push dashboard to Grafana (if configured)\nnthlayer apply payment-api.yaml --push\n</code></pre>"},{"location":"getting-started/first-service/#next-steps","title":"Next Steps","text":"<ul> <li>nthlayer apply - Full apply options</li> <li>Technologies - All 18 templates</li> <li>Service YAML Schema - Complete schema reference</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.11 or higher</li> <li>pip or pipx</li> </ul>"},{"location":"getting-started/installation/#install-with-pipx-recommended","title":"Install with pipx (Recommended)","text":"<pre><code>pipx install nthlayer\n</code></pre> <p>This installs NthLayer in an isolated environment.</p>"},{"location":"getting-started/installation/#install-with-pip","title":"Install with pip","text":"<pre><code>pip install nthlayer\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>nthlayer --version\n</code></pre>"},{"location":"getting-started/installation/#development-installation","title":"Development Installation","text":"<p>For contributors:</p> <pre><code>git clone https://github.com/rsionnach/nthlayer.git\ncd nthlayer\npip install -e \".[dev]\"\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start - Generate your first configs</li> <li>Your First Service - Create a service spec</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Generate your complete reliability stack in 5 minutes.</p>"},{"location":"getting-started/quick-start/#1-install-nthlayer","title":"1. Install NthLayer","text":"<pre><code>pipx install nthlayer\n</code></pre>"},{"location":"getting-started/quick-start/#2-run-interactive-setup","title":"2. Run Interactive Setup","text":"<pre><code>nthlayer setup\n</code></pre> <p>This guides you through configuring:</p> <ul> <li>Prometheus - For metric discovery and SLO queries</li> <li>Grafana - For dashboard deployment (optional)</li> <li>PagerDuty - For alerting integration (optional)</li> </ul> <p>Example output: <pre><code>================================================================================\n  Welcome to NthLayer!\n================================================================================\n\nQuick Setup\n----------------------------------------\n1. Prometheus Configuration\n   Prometheus URL [http://localhost:9090]:\n\n2. Grafana Configuration (optional)\n   Configure Grafana? [Y/n]: y\n   Grafana URL [http://localhost:3000]:\n   API Key: ****\n\nTesting Connections\n----------------------------------------\n  Prometheus (http://localhost:9090)\n    [OK] Connected (Prometheus 2.45.0)\n\n  Grafana (http://localhost:3000)\n    [OK] Connected - Org: Main Org\n\nConfiguration saved to: ~/.nthlayer/config.yaml\n</code></pre></p>"},{"location":"getting-started/quick-start/#3-create-a-service-spec","title":"3. Create a Service Spec","text":"<p>Create <code>payment-api.yaml</code>:</p> <pre><code>name: payment-api\ntier: critical\ntype: api\nteam: payments\n\ndependencies:\n  - postgresql\n  - redis\n</code></pre>"},{"location":"getting-started/quick-start/#4-generate-configs","title":"4. Generate Configs","text":"<pre><code>nthlayer apply payment-api.yaml\n</code></pre> <p>Output: <pre><code>Generated: generated/payment-api/\n\u251c\u2500\u2500 dashboard.json       # Import to Grafana\n\u251c\u2500\u2500 alerts.yaml          # Add to Prometheus\n\u251c\u2500\u2500 slos.yaml            # OpenSLO format\n\u2514\u2500\u2500 recording-rules.yaml # Prometheus rules\n</code></pre></p>"},{"location":"getting-started/quick-start/#5-view-your-slo-portfolio","title":"5. View Your SLO Portfolio","text":"<pre><code>nthlayer portfolio\n</code></pre> <pre><code>================================================================================\n  NthLayer SLO Portfolio\n================================================================================\n\nOrganization Health: 100% (1/1 services meeting SLOs)\n\nBy Tier:\n  Critical:  100%  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  1/1 services\n</code></pre>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Your First Service - Detailed service spec guide</li> <li>Commands - Full CLI reference</li> <li>Technologies - 18 supported technologies</li> </ul>"},{"location":"integrations/grafana/","title":"Grafana Integration","text":"<p>NthLayer generates and optionally pushes dashboards to Grafana.</p>"},{"location":"integrations/grafana/#configuration","title":"Configuration","text":""},{"location":"integrations/grafana/#via-setup-wizard","title":"Via Setup Wizard","text":"<pre><code>nthlayer setup\n</code></pre>"},{"location":"integrations/grafana/#via-environment-variables","title":"Via Environment Variables","text":"<pre><code>export NTHLAYER_GRAFANA_URL=http://grafana:3000\nexport NTHLAYER_GRAFANA_API_KEY=glsa_xxxxxxxxxxxx\nexport NTHLAYER_GRAFANA_ORG_ID=1  # Optional, default: 1\n</code></pre>"},{"location":"integrations/grafana/#via-config-file","title":"Via Config File","text":"<pre><code># ~/.nthlayer/config.yaml\ngrafana:\n  default: default\n  profiles:\n    default:\n      url: http://localhost:3000\n      type: grafana\n      org_id: 1\n      api_key_secret: grafana/api_key\n</code></pre>"},{"location":"integrations/grafana/#supported-backends","title":"Supported Backends","text":"Type Description <code>grafana</code> Self-hosted Grafana <code>grafana-cloud</code> Grafana Cloud"},{"location":"integrations/grafana/#creating-an-api-key","title":"Creating an API Key","text":"<ol> <li>Go to Administration &gt; Service accounts</li> <li>Create a new service account</li> <li>Add a token with Editor role</li> <li>Copy the token (starts with <code>glsa_</code>)</li> </ol>"},{"location":"integrations/grafana/#dashboard-generation","title":"Dashboard Generation","text":""},{"location":"integrations/grafana/#generate-only-default","title":"Generate Only (Default)","text":"<pre><code>nthlayer apply payment-api.yaml\n</code></pre> <p>Creates <code>generated/payment-api/dashboard.json</code> - import manually to Grafana.</p>"},{"location":"integrations/grafana/#auto-push-to-grafana","title":"Auto-Push to Grafana","text":"<pre><code>nthlayer apply payment-api.yaml --push\n</code></pre> <p>Pushes directly to Grafana API.</p>"},{"location":"integrations/grafana/#dashboard-structure","title":"Dashboard Structure","text":"<p>Generated dashboards include:</p>"},{"location":"integrations/grafana/#slo-metrics-row","title":"SLO Metrics Row","text":"<ul> <li>Availability - Current vs target</li> <li>Error Budget - Remaining budget gauge</li> <li>Latency P99 - Current latency vs threshold</li> </ul>"},{"location":"integrations/grafana/#service-health-row","title":"Service Health Row","text":"<ul> <li>Request Rate - Requests per second</li> <li>Error Rate - 5xx errors percentage</li> <li>Active Connections - Current connections</li> <li>Saturation - Resource utilization</li> </ul>"},{"location":"integrations/grafana/#dependencies-row","title":"Dependencies Row","text":"<p>One row per dependency with technology-specific panels:</p> <ul> <li>PostgreSQL: Connections, replication lag, locks</li> <li>Redis: Memory usage, hit rate, connections</li> <li>Kafka: Consumer lag, partition status</li> </ul>"},{"location":"integrations/grafana/#dashboard-variables","title":"Dashboard Variables","text":"<p>Dashboards include variables for filtering:</p> Variable Description <code>$service</code> Service name <code>$environment</code> Environment (dev/staging/prod)"},{"location":"integrations/grafana/#manual-import","title":"Manual Import","text":"<p>If not using <code>--push</code>:</p> <ol> <li>Go to Dashboards &gt; Import</li> <li>Upload <code>generated/&lt;service&gt;/dashboard.json</code></li> <li>Select Prometheus data source</li> <li>Click Import</li> </ol>"},{"location":"integrations/grafana/#testing-connection","title":"Testing Connection","text":"<pre><code>nthlayer setup --test\n</code></pre> <pre><code>  Grafana (http://localhost:3000)\n    [OK] Connected - Org: Main Org\n</code></pre>"},{"location":"integrations/grafana/#troubleshooting","title":"Troubleshooting","text":""},{"location":"integrations/grafana/#invalid-api-key","title":"Invalid API Key","text":"<pre><code>[FAIL] Invalid API key\n</code></pre> <ul> <li>Verify token starts with <code>glsa_</code></li> <li>Check token has Editor role</li> <li>Ensure token isn't expired</li> </ul>"},{"location":"integrations/grafana/#dashboard-already-exists","title":"Dashboard Already Exists","text":"<p>Dashboards are upserted by UID. Existing dashboards with the same UID are updated.</p>"},{"location":"integrations/grafana/#wrong-organization","title":"Wrong Organization","text":"<p>Set <code>NTHLAYER_GRAFANA_ORG_ID</code> if using multiple orgs:</p> <pre><code>export NTHLAYER_GRAFANA_ORG_ID=2\n</code></pre>"},{"location":"integrations/pagerduty/","title":"PagerDuty Integration","text":"<p>NthLayer can create and manage PagerDuty teams, services, and escalation policies.</p>"},{"location":"integrations/pagerduty/#configuration","title":"Configuration","text":""},{"location":"integrations/pagerduty/#via-setup-wizard","title":"Via Setup Wizard","text":"<pre><code>nthlayer setup\n</code></pre>"},{"location":"integrations/pagerduty/#via-environment-variable","title":"Via Environment Variable","text":"<pre><code>export PAGERDUTY_API_KEY=u+xxxxxxxxxxxxxxxxxx\n</code></pre>"},{"location":"integrations/pagerduty/#via-config-file","title":"Via Config File","text":"<pre><code># ~/.nthlayer/config.yaml\nalerting:\n  pagerduty:\n    enabled: true\n    api_key_secret: pagerduty/api_key\n    default_escalation_policy: P123ABC\n</code></pre>"},{"location":"integrations/pagerduty/#getting-an-api-key","title":"Getting an API Key","text":"<ol> <li>Go to Integrations &gt; API Access Keys</li> <li>Create a new REST API Key</li> <li>Select Full Access permissions</li> <li>Copy the key (starts with <code>u+</code>)</li> </ol>"},{"location":"integrations/pagerduty/#service-spec-configuration","title":"Service Spec Configuration","text":"<pre><code>name: payment-api\nteam: payments\ntier: critical\ntype: api\n\nresources:\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      urgency: high           # high or low\n      auto_create: true       # Create team/service automatically\n      escalation_policy: P123ABC  # Optional: use existing policy\n</code></pre>"},{"location":"integrations/pagerduty/#what-gets-created","title":"What Gets Created","text":"<p>When <code>auto_create: true</code>:</p>"},{"location":"integrations/pagerduty/#team","title":"Team","text":"<pre><code>Name: payments\nDescription: Auto-created by NthLayer\n</code></pre>"},{"location":"integrations/pagerduty/#escalation-policy","title":"Escalation Policy","text":"<pre><code>Name: payments-escalation\nRules:\n  - Escalate to team \"payments\" after 5 minutes (critical)\n  - Escalate to team \"payments\" after 15 minutes (standard)\n</code></pre>"},{"location":"integrations/pagerduty/#service","title":"Service","text":"<pre><code>Name: payment-api\nDescription: payment-api reliability alerts\nEscalation Policy: payments-escalation\nUrgency: high\n</code></pre>"},{"location":"integrations/pagerduty/#tier-based-escalation","title":"Tier-Based Escalation","text":"Tier Urgency Escalation Time Critical (1) High 5 minutes Standard (2) Low 15 minutes Low (3) Low 30 minutes"},{"location":"integrations/pagerduty/#manual-setup","title":"Manual Setup","text":"<p>To use existing PagerDuty resources:</p> <pre><code>resources:\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      auto_create: false\n      service_id: PXXXXXX\n      escalation_policy: PXXXXXX\n</code></pre>"},{"location":"integrations/pagerduty/#alert-integration","title":"Alert Integration","text":"<p>Generated Prometheus alerts include PagerDuty annotations:</p> <pre><code>- alert: PaymentApiHighErrorRate\n  annotations:\n    pagerduty_service: payment-api\n    runbook_url: https://wiki.example.com/runbooks/payment-api\n</code></pre>"},{"location":"integrations/pagerduty/#testing-connection","title":"Testing Connection","text":"<pre><code>nthlayer setup --test\n</code></pre> <pre><code>  PagerDuty\n    [OK] Connected - 3 escalation policies\n</code></pre>"},{"location":"integrations/pagerduty/#troubleshooting","title":"Troubleshooting","text":""},{"location":"integrations/pagerduty/#invalid-api-key","title":"Invalid API Key","text":"<pre><code>[FAIL] Invalid API key\n</code></pre> <ul> <li>Verify key starts with <code>u+</code></li> <li>Check key has Full Access</li> <li>Ensure key isn't revoked</li> </ul>"},{"location":"integrations/pagerduty/#team-already-exists","title":"Team Already Exists","text":"<p>NthLayer checks for existing teams by name and reuses them.</p>"},{"location":"integrations/pagerduty/#permission-denied","title":"Permission Denied","text":"<p>Ensure API key has permissions to:</p> <ul> <li>Create/update teams</li> <li>Create/update services</li> <li>Create/update escalation policies</li> </ul>"},{"location":"integrations/prometheus/","title":"Prometheus Integration","text":"<p>NthLayer uses Prometheus for metric discovery, SLO queries, and alert rules.</p>"},{"location":"integrations/prometheus/#configuration","title":"Configuration","text":""},{"location":"integrations/prometheus/#via-setup-wizard","title":"Via Setup Wizard","text":"<pre><code>nthlayer setup\n</code></pre>"},{"location":"integrations/prometheus/#via-environment-variables","title":"Via Environment Variables","text":"<pre><code>export NTHLAYER_PROMETHEUS_URL=http://prometheus:9090\n\n# If authentication required\nexport NTHLAYER_METRICS_USER=admin\nexport NTHLAYER_METRICS_PASSWORD=secret\n</code></pre>"},{"location":"integrations/prometheus/#via-config-file","title":"Via Config File","text":"<pre><code># ~/.nthlayer/config.yaml\nprometheus:\n  default: default\n  profiles:\n    default:\n      url: http://localhost:9090\n      type: prometheus\n    production:\n      url: https://prometheus-prod.example.com\n      type: prometheus\n      username: admin\n      password_secret: prometheus/password\n</code></pre>"},{"location":"integrations/prometheus/#supported-backends","title":"Supported Backends","text":"Type Description <code>prometheus</code> Standard Prometheus server <code>mimir</code> Grafana Mimir <code>grafana-cloud</code> Grafana Cloud Prometheus"},{"location":"integrations/prometheus/#what-nthlayer-generates","title":"What NthLayer Generates","text":""},{"location":"integrations/prometheus/#alert-rules","title":"Alert Rules","text":"<pre><code>groups:\n  - name: payment-api-alerts\n    rules:\n      - alert: PaymentApiHighErrorRate\n        expr: |\n          sum(rate(http_requests_total{service=\"payment-api\",status=~\"5..\"}[5m])) /\n          sum(rate(http_requests_total{service=\"payment-api\"}[5m])) &gt; 0.01\n        for: 5m\n        labels:\n          severity: critical\n          service: payment-api\n        annotations:\n          summary: High error rate on payment-api\n          description: Error rate is {{ $value | humanizePercentage }}\n</code></pre>"},{"location":"integrations/prometheus/#recording-rules","title":"Recording Rules","text":"<pre><code>groups:\n  - name: payment-api-recording\n    rules:\n      - record: service:http_requests:rate5m\n        expr: sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n      - record: service:http_errors:rate5m\n        expr: sum(rate(http_requests_total{service=\"payment-api\",status=~\"5..\"}[5m]))\n      - record: service:http_latency_p99:5m\n        expr: |\n          histogram_quantile(0.99,\n            sum by (le) (rate(http_request_duration_seconds_bucket{service=\"payment-api\"}[5m]))\n          )\n</code></pre>"},{"location":"integrations/prometheus/#slo-queries","title":"SLO Queries","text":"<p>NthLayer queries Prometheus for live SLO status:</p> <pre><code>nthlayer slo collect payment-api.yaml\n</code></pre> <p>Uses queries like:</p> <pre><code># Availability over 30 days\navg_over_time(\n  (\n    sum(rate(http_requests_total{service=\"payment-api\",status!~\"5..\"}[5m])) /\n    sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n  )[30d:5m]\n)\n</code></pre>"},{"location":"integrations/prometheus/#metric-discovery","title":"Metric Discovery","text":"<p>NthLayer discovers available metrics to customize dashboards:</p> <pre><code># Discovers metrics matching service label\nnthlayer plan payment-api.yaml --discover\n</code></pre>"},{"location":"integrations/prometheus/#testing-connection","title":"Testing Connection","text":"<pre><code>nthlayer setup --test\n</code></pre> <pre><code>  Prometheus (http://localhost:9090)\n    [OK] Connected (Prometheus 2.45.0)\n</code></pre>"},{"location":"integrations/prometheus/#troubleshooting","title":"Troubleshooting","text":""},{"location":"integrations/prometheus/#connection-refused","title":"Connection Refused","text":"<pre><code>[FAIL] Connection refused - is Prometheus running?\n</code></pre> <ul> <li>Verify Prometheus is running: <code>curl http://localhost:9090/-/healthy</code></li> <li>Check firewall rules</li> <li>Verify URL is correct</li> </ul>"},{"location":"integrations/prometheus/#authentication-failed","title":"Authentication Failed","text":"<pre><code>[FAIL] Authentication required\n</code></pre> <ul> <li>Set <code>NTHLAYER_METRICS_USER</code> and <code>NTHLAYER_METRICS_PASSWORD</code></li> <li>Or configure in <code>~/.nthlayer/config.yaml</code></li> </ul>"},{"location":"integrations/prometheus/#no-metrics-found","title":"No Metrics Found","text":"<ul> <li>Ensure your application exports metrics with <code>service</code> label</li> <li>Check metric names match expected patterns</li> </ul>"},{"location":"integrations/technologies/","title":"Supported Technologies","text":"<p>NthLayer includes pre-built monitoring templates for 18 technologies.</p>"},{"location":"integrations/technologies/#overview","title":"Overview","text":"Category Technologies Databases PostgreSQL, MySQL, MongoDB, Redis, Elasticsearch Message Queues Kafka, RabbitMQ, NATS, Pulsar Proxies/Load Balancers Nginx, HAProxy, Traefik Infrastructure Kubernetes, etcd, Consul"},{"location":"integrations/technologies/#databases","title":"Databases","text":""},{"location":"integrations/technologies/#postgresql","title":"PostgreSQL","text":"<pre><code>dependencies:\n  - postgresql\n</code></pre> <p>Generated Panels:</p> Panel Metric Active Connections <code>pg_stat_activity_count</code> Replication Lag <code>pg_replication_lag</code> Transactions/sec <code>pg_stat_database_xact_commit</code> Cache Hit Ratio <code>pg_stat_database_blks_hit</code> Dead Tuples <code>pg_stat_user_tables_n_dead_tup</code> <p>Alerts:</p> <ul> <li>High connection count (&gt; 80% of max)</li> <li>Replication lag &gt; 30s</li> <li>Low cache hit ratio (&lt; 90%)</li> </ul>"},{"location":"integrations/technologies/#mysql-mariadb","title":"MySQL / MariaDB","text":"<pre><code>dependencies:\n  - mysql\n  # or\n  - mariadb\n</code></pre> <p>Generated Panels:</p> Panel Metric Connections <code>mysql_global_status_threads_connected</code> Queries/sec <code>mysql_global_status_queries</code> Slow Queries <code>mysql_global_status_slow_queries</code> Replication Lag <code>mysql_slave_status_seconds_behind_master</code>"},{"location":"integrations/technologies/#mongodb","title":"MongoDB","text":"<pre><code>dependencies:\n  - mongodb\n</code></pre> <p>Generated Panels:</p> Panel Metric Connections <code>mongodb_connections</code> Operations/sec <code>mongodb_op_counters_total</code> Replication Lag <code>mongodb_replset_member_replication_lag</code> Document Operations <code>mongodb_mongod_metrics_document_total</code>"},{"location":"integrations/technologies/#redis","title":"Redis","text":"<pre><code>dependencies:\n  - redis\n</code></pre> <p>Generated Panels:</p> Panel Metric Memory Usage <code>redis_memory_used_bytes</code> Connected Clients <code>redis_connected_clients</code> Hit Rate <code>redis_keyspace_hits_total / (hits + misses)</code> Commands/sec <code>redis_commands_processed_total</code> Evictions <code>redis_evicted_keys_total</code>"},{"location":"integrations/technologies/#elasticsearch","title":"Elasticsearch","text":"<pre><code>dependencies:\n  - elasticsearch\n</code></pre> <p>Generated Panels:</p> Panel Metric Cluster Health <code>elasticsearch_cluster_health_status</code> JVM Heap <code>elasticsearch_jvm_memory_used_bytes</code> Indexing Rate <code>elasticsearch_indices_indexing_index_total</code> Search Rate <code>elasticsearch_indices_search_query_total</code> Pending Tasks <code>elasticsearch_cluster_health_number_of_pending_tasks</code>"},{"location":"integrations/technologies/#message-queues","title":"Message Queues","text":""},{"location":"integrations/technologies/#kafka","title":"Kafka","text":"<pre><code>dependencies:\n  - kafka\n</code></pre> <p>Generated Panels:</p> Panel Metric Consumer Lag <code>kafka_consumer_group_lag</code> Messages/sec <code>kafka_server_brokertopicmetrics_messagesin_total</code> Partitions <code>kafka_topic_partitions</code> Under-replicated <code>kafka_server_replicamanager_underreplicatedpartitions</code> <p>Alerts:</p> <ul> <li>Consumer lag &gt; 10,000 messages</li> <li>Under-replicated partitions &gt; 0</li> </ul>"},{"location":"integrations/technologies/#rabbitmq","title":"RabbitMQ","text":"<pre><code>dependencies:\n  - rabbitmq\n  # or\n  - rabbit\n</code></pre> <p>Generated Panels:</p> Panel Metric Queue Messages <code>rabbitmq_queue_messages</code> Consumers <code>rabbitmq_queue_consumers</code> Publish Rate <code>rabbitmq_channel_messages_published_total</code> Connections <code>rabbitmq_connections</code> Memory <code>rabbitmq_node_mem_used</code>"},{"location":"integrations/technologies/#nats","title":"NATS","text":"<pre><code>dependencies:\n  - nats\n</code></pre> <p>Generated Panels:</p> Panel Metric Connections <code>nats_connections</code> Messages In/Out <code>nats_messages_total</code> Bytes In/Out <code>nats_bytes_total</code> Subscriptions <code>nats_subscriptions</code> Slow Consumers <code>nats_slow_consumers</code>"},{"location":"integrations/technologies/#pulsar","title":"Pulsar","text":"<pre><code>dependencies:\n  - pulsar\n</code></pre> <p>Generated Panels:</p> Panel Metric Throughput In <code>pulsar_throughput_in</code> Throughput Out <code>pulsar_throughput_out</code> Message Backlog <code>pulsar_msg_backlog</code> Subscriptions <code>pulsar_subscriptions_count</code> Storage Size <code>pulsar_storage_size</code>"},{"location":"integrations/technologies/#proxies-load-balancers","title":"Proxies / Load Balancers","text":""},{"location":"integrations/technologies/#nginx","title":"Nginx","text":"<pre><code>dependencies:\n  - nginx\n</code></pre> <p>Generated Panels:</p> Panel Metric Requests/sec <code>nginx_http_requests_total</code> Active Connections <code>nginx_connections_active</code> Response Codes <code>nginx_http_requests_total</code> by status Request Duration <code>nginx_http_request_duration_seconds</code> Upstream Response Time <code>nginx_upstream_response_time</code>"},{"location":"integrations/technologies/#haproxy","title":"HAProxy","text":"<pre><code>dependencies:\n  - haproxy\n</code></pre> <p>Generated Panels:</p> Panel Metric Request Rate <code>haproxy_frontend_http_requests_total</code> Active Connections <code>haproxy_frontend_current_sessions</code> Response Time <code>haproxy_backend_response_time_average_seconds</code> Backend Status <code>haproxy_backend_up</code> Error Rate <code>haproxy_backend_http_responses_total{code=\"5xx\"}</code> Queue Length <code>haproxy_backend_current_queue</code>"},{"location":"integrations/technologies/#traefik","title":"Traefik","text":"<pre><code>dependencies:\n  - traefik\n</code></pre> <p>Generated Panels:</p> Panel Metric Requests/sec <code>traefik_service_requests_total</code> Request Duration <code>traefik_service_request_duration_seconds</code> Response Codes <code>traefik_service_requests_total</code> by code Open Connections <code>traefik_service_open_connections</code> Entrypoint Requests <code>traefik_entrypoint_requests_total</code>"},{"location":"integrations/technologies/#infrastructure","title":"Infrastructure","text":""},{"location":"integrations/technologies/#kubernetes","title":"Kubernetes","text":"<pre><code>dependencies:\n  - kubernetes\n</code></pre> <p>Generated Panels:</p> Panel Metric Pod Status <code>kube_pod_status_phase</code> Container Restarts <code>kube_pod_container_status_restarts_total</code> CPU Usage <code>container_cpu_usage_seconds_total</code> Memory Usage <code>container_memory_usage_bytes</code> PVC Usage <code>kubelet_volume_stats_used_bytes</code>"},{"location":"integrations/technologies/#etcd","title":"etcd","text":"<pre><code>dependencies:\n  - etcd\n</code></pre> <p>Generated Panels:</p> Panel Metric Leader Status <code>etcd_server_has_leader</code> DB Size <code>etcd_mvcc_db_total_size_in_bytes</code> Proposals <code>etcd_server_proposals_committed_total</code> WAL Fsync <code>etcd_disk_wal_fsync_duration_seconds</code> Network Peer RTT <code>etcd_network_peer_round_trip_time_seconds</code>"},{"location":"integrations/technologies/#consul","title":"Consul","text":"<pre><code>dependencies:\n  - consul\n</code></pre> <p>Generated Panels:</p> Panel Metric Leader <code>consul_raft_leader</code> Peers <code>consul_raft_peers</code> Services <code>consul_catalog_services</code> Health Checks <code>consul_health_checks_critical</code> RPC Rate <code>consul_rpc_request</code>"},{"location":"integrations/technologies/#adding-custom-technologies","title":"Adding Custom Technologies","text":"<p>See Service Specifications for extending with your own configurations.</p>"},{"location":"reference/cli/","title":"CLI Reference","text":"<p>Complete command-line interface reference.</p>"},{"location":"reference/cli/#global-options","title":"Global Options","text":"<pre><code>nthlayer [--help] [--version] &lt;command&gt;\n</code></pre> Option Description <code>--help</code> Show help message <code>--version</code> Show version number"},{"location":"reference/cli/#commands","title":"Commands","text":""},{"location":"reference/cli/#apply","title":"apply","text":"<p>Generate reliability configs from service spec.</p> <pre><code>nthlayer apply &lt;service.yaml&gt; [options]\n</code></pre> Option Description <code>--push</code> Push dashboard to Grafana <code>--output-dir DIR</code> Custom output directory <code>--dry-run</code> Preview without writing"},{"location":"reference/cli/#setup","title":"setup","text":"<p>Interactive first-time setup.</p> <pre><code>nthlayer setup [options]\n</code></pre> Option Description <code>--quick</code> Simplified setup (default) <code>--advanced</code> Full configuration wizard <code>--test</code> Test connections only <code>--skip-service</code> Skip first service creation"},{"location":"reference/cli/#portfolio","title":"portfolio","text":"<p>View org-wide SLO health.</p> <pre><code>nthlayer portfolio [options]\n</code></pre> Option Description <code>--format FORMAT</code> Output: text, json, csv <code>--services-dir DIR</code> Directory to scan"},{"location":"reference/cli/#slo","title":"slo","text":"<p>SLO management commands.</p> <pre><code>nthlayer slo &lt;subcommand&gt; &lt;service.yaml&gt;\n</code></pre> Subcommand Description <code>show</code> Display SLO definitions <code>list</code> Brief SLO listing <code>collect</code> Query live metrics <p>Options for <code>collect</code>:</p> Option Description <code>--prometheus-url URL</code> Prometheus server <code>--window DURATION</code> Query window"},{"location":"reference/cli/#config","title":"config","text":"<p>Configuration management.</p> <pre><code>nthlayer config &lt;subcommand&gt;\n</code></pre> Subcommand Description <code>show</code> Show current config <code>init</code> Interactive wizard <code>set KEY VALUE</code> Set config value <p>Options for <code>show</code>:</p> Option Description <code>--reveal-secrets</code> Show secret values"},{"location":"reference/cli/#plan","title":"plan","text":"<p>Preview what would be generated.</p> <pre><code>nthlayer plan &lt;service.yaml&gt;\n</code></pre>"},{"location":"reference/cli/#validate","title":"validate","text":"<p>Validate service spec.</p> <pre><code>nthlayer validate &lt;service.yaml&gt;\n</code></pre>"},{"location":"reference/cli/#generate-dashboard","title":"generate-dashboard","text":"<p>Generate dashboard only.</p> <pre><code>nthlayer generate-dashboard &lt;service.yaml&gt; [options]\n</code></pre> Option Description <code>--push</code> Push to Grafana"},{"location":"reference/cli/#generate-alerts","title":"generate-alerts","text":"<p>Generate alerts only.</p> <pre><code>nthlayer generate-alerts &lt;service.yaml&gt;\n</code></pre>"},{"location":"reference/cli/#generate-slo","title":"generate-slo","text":"<p>Generate SLO definitions only.</p> <pre><code>nthlayer generate-slo &lt;service.yaml&gt;\n</code></pre>"},{"location":"reference/cli/#generate-recording-rules","title":"generate-recording-rules","text":"<p>Generate recording rules only.</p> <pre><code>nthlayer generate-recording-rules &lt;service.yaml&gt;\n</code></pre>"},{"location":"reference/cli/#setup-pagerduty","title":"setup-pagerduty","text":"<p>Configure PagerDuty for service.</p> <pre><code>nthlayer setup-pagerduty &lt;service.yaml&gt; [options]\n</code></pre> Option Description <code>--api-key KEY</code> PagerDuty API key <code>--dry-run</code> Preview changes"},{"location":"reference/cli/#lint","title":"lint","text":"<p>Lint generated Prometheus rules.</p> <pre><code>nthlayer lint &lt;alerts.yaml&gt;\n</code></pre> <p>Uses pint for validation.</p>"},{"location":"reference/cli/#init","title":"init","text":"<p>Create new service spec from template.</p> <pre><code>nthlayer init [options]\n</code></pre> Option Description <code>--name NAME</code> Service name <code>--team TEAM</code> Team name <code>--template TEMPLATE</code> Template name"},{"location":"reference/cli/#list-templates","title":"list-templates","text":"<p>Show available templates.</p> <pre><code>nthlayer list-templates\n</code></pre>"},{"location":"reference/cli/#secrets","title":"secrets","text":"<p>Secret management commands.</p> <pre><code>nthlayer secrets &lt;subcommand&gt;\n</code></pre> Subcommand Description <code>list</code> List available secrets <code>verify</code> Verify required secrets <code>set PATH</code> Set a secret <code>get PATH</code> Get a secret <code>migrate SOURCE TARGET</code> Migrate secrets"},{"location":"reference/cli/#environment-variables","title":"Environment Variables","text":"Variable Description <code>NTHLAYER_PROMETHEUS_URL</code> Prometheus server URL <code>NTHLAYER_GRAFANA_URL</code> Grafana server URL <code>NTHLAYER_GRAFANA_API_KEY</code> Grafana API key <code>NTHLAYER_GRAFANA_ORG_ID</code> Grafana organization ID <code>PAGERDUTY_API_KEY</code> PagerDuty API key <code>NTHLAYER_PROFILE</code> Config profile to use"},{"location":"reference/cli/#exit-codes","title":"Exit Codes","text":"Code Meaning <code>0</code> Success <code>1</code> General error <code>2</code> Invalid arguments <code>3</code> Configuration error <code>4</code> Connection error"},{"location":"reference/service-yaml/","title":"Service YAML Schema","text":"<p>Complete reference for service specification files.</p>"},{"location":"reference/service-yaml/#full-schema","title":"Full Schema","text":"<pre><code># Required fields\nname: string              # Service identifier (lowercase, hyphens)\ntier: integer | string    # 1/2/3 or critical/standard/low\ntype: string              # api, worker, stream\n\n# Optional fields\nteam: string              # Team name\ndescription: string       # Human-readable description\n\n# Technology dependencies\ndependencies:\n  - string                # postgresql, redis, kafka, etc.\n\n# Custom resource definitions\nresources:\n  - kind: string          # SLO, Alert, PagerDuty, Dependencies\n    name: string          # Resource identifier\n    spec: object          # Resource-specific configuration\n\n# Environment-specific overrides\nenvironments:\n  production: object      # Override for production\n  staging: object         # Override for staging\n</code></pre>"},{"location":"reference/service-yaml/#field-reference","title":"Field Reference","text":""},{"location":"reference/service-yaml/#name","title":"name","text":"<p>Required | <code>string</code></p> <p>Service identifier. Must be:</p> <ul> <li>Lowercase letters, numbers, hyphens only</li> <li>Cannot start or end with hyphen</li> <li>Unique within your organization</li> </ul> <pre><code>name: payment-api        # Valid\nname: Payment-API        # Invalid (uppercase)\nname: -payment-api       # Invalid (starts with hyphen)\n</code></pre>"},{"location":"reference/service-yaml/#tier","title":"tier","text":"<p>Required | <code>integer</code> or <code>string</code></p> <p>Service priority level:</p> Value Meaning Default SLO <code>1</code> / <code>critical</code> Business-critical 99.95% <code>2</code> / <code>standard</code> Important 99.9% <code>3</code> / <code>low</code> Best-effort 99.5% <pre><code>tier: 1\n# or\ntier: critical\n</code></pre>"},{"location":"reference/service-yaml/#type","title":"type","text":"<p>Required | <code>string</code></p> <p>Service type determines default metrics and SLOs:</p> Type Description <code>api</code> HTTP/REST service <code>worker</code> Background job processor <code>stream</code> Event/message processor"},{"location":"reference/service-yaml/#team","title":"team","text":"<p>Optional | <code>string</code></p> <p>Team responsible for the service. Used for:</p> <ul> <li>PagerDuty team creation</li> <li>Dashboard grouping</li> <li>Alert routing</li> </ul> <pre><code>team: payments\n</code></pre>"},{"location":"reference/service-yaml/#dependencies","title":"dependencies","text":"<p>Optional | <code>list[string]</code></p> <p>Technology dependencies. Each adds dashboard panels and alerts.</p> <pre><code>dependencies:\n  - postgresql\n  - redis\n  - kafka\n</code></pre> <p>Supported values: See Technologies</p>"},{"location":"reference/service-yaml/#resources","title":"resources","text":"<p>Optional | <code>list[Resource]</code></p> <p>Custom resource definitions.</p>"},{"location":"reference/service-yaml/#slo-resource","title":"SLO Resource","text":"<pre><code>resources:\n  - kind: SLO\n    name: availability      # Unique name\n    spec:\n      objective: 99.95      # Target percentage\n      window: 30d           # Time window\n      threshold_ms: 200     # For latency SLOs\n      indicator:\n        type: availability  # availability, latency, throughput\n        percentile: 99      # For latency SLOs\n        query: |            # PromQL query\n          sum(rate(...))\n</code></pre>"},{"location":"reference/service-yaml/#alert-resource","title":"Alert Resource","text":"<pre><code>resources:\n  - kind: Alert\n    name: high-error-rate\n    spec:\n      expr: |               # PromQL expression\n        sum(rate(http_requests_total{status=~\"5..\"}[5m])) /\n        sum(rate(http_requests_total[5m])) &gt; 0.01\n      for: 5m               # Duration before firing\n      severity: critical    # critical, warning, info\n      labels:\n        team: payments\n      annotations:\n        summary: \"High error rate\"\n        description: \"{{ $value | humanizePercentage }}\"\n</code></pre>"},{"location":"reference/service-yaml/#pagerduty-resource","title":"PagerDuty Resource","text":"<pre><code>resources:\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      urgency: high         # high, low\n      auto_create: true     # Create team/service automatically\n      service_id: PXXXXXX   # Use existing service\n      escalation_policy: PXXXXXX\n</code></pre>"},{"location":"reference/service-yaml/#dependencies-resource","title":"Dependencies Resource","text":"<pre><code>resources:\n  - kind: Dependencies\n    name: upstream\n    spec:\n      services:\n        - name: user-service\n          criticality: high\n        - name: inventory-service\n          criticality: medium\n</code></pre>"},{"location":"reference/service-yaml/#environments","title":"environments","text":"<p>Optional | <code>object</code></p> <p>Environment-specific overrides:</p> <pre><code>environments:\n  production:\n    tier: critical\n    resources:\n      - kind: SLO\n        name: availability\n        spec:\n          objective: 99.99\n\n  staging:\n    tier: standard\n    resources:\n      - kind: SLO\n        name: availability\n        spec:\n          objective: 99.5\n</code></pre>"},{"location":"reference/service-yaml/#complete-example","title":"Complete Example","text":"<pre><code>name: payment-api\nteam: payments\ntier: critical\ntype: api\ndescription: Handles payment processing\n\ndependencies:\n  - postgresql\n  - redis\n\nresources:\n  - kind: SLO\n    name: availability\n    spec:\n      objective: 99.95\n      window: 30d\n      indicator:\n        type: availability\n        query: |\n          sum(rate(http_requests_total{service=\"payment-api\",status!~\"5..\"}[5m])) /\n          sum(rate(http_requests_total{service=\"payment-api\"}[5m]))\n\n  - kind: SLO\n    name: latency-p99\n    spec:\n      objective: 99.0\n      window: 30d\n      threshold_ms: 200\n      indicator:\n        type: latency\n        percentile: 99\n        query: |\n          histogram_quantile(0.99,\n            sum by (le) (rate(http_request_duration_seconds_bucket{service=\"payment-api\"}[5m]))\n          )\n\n  - kind: Alert\n    name: high-error-rate\n    spec:\n      expr: |\n        sum(rate(http_requests_total{service=\"payment-api\",status=~\"5..\"}[5m])) /\n        sum(rate(http_requests_total{service=\"payment-api\"}[5m])) &gt; 0.01\n      for: 5m\n      severity: critical\n\n  - kind: PagerDuty\n    name: alerting\n    spec:\n      urgency: high\n      auto_create: true\n\nenvironments:\n  production:\n    resources:\n      - kind: SLO\n        name: availability\n        spec:\n          objective: 99.99\n</code></pre>"},{"location":"reference/service-yaml/#validation","title":"Validation","text":"<pre><code>nthlayer validate payment-api.yaml\n</code></pre>"}]}
